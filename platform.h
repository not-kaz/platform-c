#ifndef PLATFORM_H
#define PLATFORM_H
#include <stdbool.h>
#include <stdint.h>
#define PLATFORM_WINDOW_TITLE_MAX_LEN 64

/* NOTE: HID keycode values taken from:
 * 'https://gist.github.com/mildsunrise/4e231346e2078f440969cdefb6d4caa3'*/
enum platform_keycode {
	/* None */
	PLATFORM_KEYCODE_NONE = 0x00000000u,
	/* Error */
	PLATFORM_KEYCODE_ERROR_ROLLOVER = 0x00070001u,
	PLATFORM_KEYCODE_POST_FAIL = 0x00070002u,
	PLATFORM_KEYCODE_ERROR_UNDEFINED = 0x00070003u,
	/* Letters */
	PLATFORM_KEYCODE_A = 0x00070004u,
	PLATFORM_KEYCODE_B = 0x00070005u,
	PLATFORM_KEYCODE_C = 0x00070006u,
	PLATFORM_KEYCODE_D = 0x00070007u,
	PLATFORM_KEYCODE_E = 0x00070008u,
	PLATFORM_KEYCODE_F = 0x00070009u,
	PLATFORM_KEYCODE_G = 0x0007000Au,
	PLATFORM_KEYCODE_H = 0x0007000Bu,
	PLATFORM_KEYCODE_I = 0x0007000Cu,
	PLATFORM_KEYCODE_J = 0x0007000Du,
	PLATFORM_KEYCODE_K = 0x0007000Eu,
	PLATFORM_KEYCODE_L = 0x0007000Fu,
	PLATFORM_KEYCODE_M = 0x00070010u,
	PLATFORM_KEYCODE_N = 0x00070011u,
	PLATFORM_KEYCODE_O = 0x00070012u,
	PLATFORM_KEYCODE_P = 0x00070013u,
	PLATFORM_KEYCODE_Q = 0x00070014u,
	PLATFORM_KEYCODE_R = 0x00070015u,
	PLATFORM_KEYCODE_S = 0x00070016u,
	PLATFORM_KEYCODE_T = 0x00070017u,
	PLATFORM_KEYCODE_U = 0x00070018u,
	PLATFORM_KEYCODE_V = 0x00070019u,
	PLATFORM_KEYCODE_W = 0x0007001Au,
	PLATFORM_KEYCODE_X = 0x0007001Bu,
	PLATFORM_KEYCODE_Y = 0x0007001Cu,
	PLATFORM_KEYCODE_Z = 0x0007001Du,
	/* Digits */
	PLATFORM_KEYCODE_1 = 0x0007001Eu,
	PLATFORM_KEYCODE_2 = 0x0007001Fu,
	PLATFORM_KEYCODE_3 = 0x00070020u,
	PLATFORM_KEYCODE_4 = 0x00070021u,
	PLATFORM_KEYCODE_5 = 0x00070022u,
	PLATFORM_KEYCODE_6 = 0x00070023u,
	PLATFORM_KEYCODE_7 = 0x00070024u,
	PLATFORM_KEYCODE_8 = 0x00070025u,
	PLATFORM_KEYCODE_9 = 0x00070026u,
	PLATFORM_KEYCODE_0 = 0x00070027u,
	/* Control and whitespace */
	PLATFORM_KEYCODE_ENTER = 0x00070028u,
	PLATFORM_KEYCODE_ESCAPE = 0x00070029u,
	PLATFORM_KEYCODE_BACKSPACE = 0x0007002Au,
	PLATFORM_KEYCODE_TAB = 0x0007002Bu,
	PLATFORM_KEYCODE_SPACE = 0x0007002Cu,
	/* Punctuation and symbols */
	PLATFORM_KEYCODE_MINUS = 0x0007002Du,
	PLATFORM_KEYCODE_EQUAL = 0x0007002Eu,
	PLATFORM_KEYCODE_LEFT_BRACKET = 0x0007002Fu,
	PLATFORM_KEYCODE_RIGHT_BRACKET = 0x00070030u,
	PLATFORM_KEYCODE_BACKSLASH = 0x00070031u,
	PLATFORM_KEYCODE_NON_US_HASH_TILDE = 0x00070032u,
	PLATFORM_KEYCODE_SEMICOLON = 0x00070033u,
	PLATFORM_KEYCODE_APOSTROPHE = 0x00070034u,
	PLATFORM_KEYCODE_GRAVE = 0x00070035u,
	PLATFORM_KEYCODE_COMMA = 0x00070036u,
	PLATFORM_KEYCODE_PERIOD = 0x00070037u,
	PLATFORM_KEYCODE_SLASH = 0x00070038u,
	/* Locks */
	PLATFORM_KEYCODE_CAPS_LOCK = 0x00070039u,
	/* Function keys */
	PLATFORM_KEYCODE_F1 = 0x0007003Au,
	PLATFORM_KEYCODE_F2 = 0x0007003Bu,
	PLATFORM_KEYCODE_F3 = 0x0007003Cu,
	PLATFORM_KEYCODE_F4 = 0x0007003Du,
	PLATFORM_KEYCODE_F5 = 0x0007003Eu,
	PLATFORM_KEYCODE_F6 = 0x0007003Fu,
	PLATFORM_KEYCODE_F7 = 0x00070040u,
	PLATFORM_KEYCODE_F8 = 0x00070041u,
	PLATFORM_KEYCODE_F9 = 0x00070042u,
	PLATFORM_KEYCODE_F10 = 0x00070043u,
	PLATFORM_KEYCODE_F11 = 0x00070044u,
	PLATFORM_KEYCODE_F12 = 0x00070045u,
	PLATFORM_KEYCODE_F13 = 0x00070068u,
	PLATFORM_KEYCODE_F14 = 0x00070069u,
	PLATFORM_KEYCODE_F15 = 0x0007006Au,
	PLATFORM_KEYCODE_F16 = 0x0007006Bu,
	PLATFORM_KEYCODE_F17 = 0x0007006Cu,
	PLATFORM_KEYCODE_F18 = 0x0007006Du,
	PLATFORM_KEYCODE_F19 = 0x0007006Eu,
	PLATFORM_KEYCODE_F20 = 0x0007006Fu,
	PLATFORM_KEYCODE_F21 = 0x00070070u,
	PLATFORM_KEYCODE_F22 = 0x00070071u,
	PLATFORM_KEYCODE_F23 = 0x00070072u,
	PLATFORM_KEYCODE_F24 = 0x00070073u,
	/* System keys */
	PLATFORM_KEYCODE_PRINT_SCREEN = 0x00070046u,
	PLATFORM_KEYCODE_SCROLL_LOCK = 0x00070047u,
	PLATFORM_KEYCODE_PAUSE = 0x00070048u,
	/* Navigation */
	PLATFORM_KEYCODE_INSERT = 0x00070049u,
	PLATFORM_KEYCODE_HOME = 0x0007004Au,
	PLATFORM_KEYCODE_PAGE_UP = 0x0007004Bu,
	PLATFORM_KEYCODE_DELETE_FORWARD = 0x0007004Cu,
	PLATFORM_KEYCODE_END = 0x0007004Du,
	PLATFORM_KEYCODE_PAGE_DOWN = 0x0007004Eu,
	PLATFORM_KEYCODE_RIGHT_ARROW = 0x0007004Fu,
	PLATFORM_KEYCODE_LEFT_ARROW = 0x00070050u,
	PLATFORM_KEYCODE_DOWN_ARROW = 0x00070051u,
	PLATFORM_KEYCODE_UP_ARROW = 0x00070052u,
	/* Keypad */
	PLATFORM_KEYCODE_NUM_LOCK = 0x00070053u,
	PLATFORM_KEYCODE_KP_DIVIDE = 0x00070054u,
	PLATFORM_KEYCODE_KP_MULTIPLY = 0x00070055u,
	PLATFORM_KEYCODE_KP_MINUS = 0x00070056u,
	PLATFORM_KEYCODE_KP_PLUS = 0x00070057u,
	PLATFORM_KEYCODE_KP_ENTER = 0x00070058u,
	PLATFORM_KEYCODE_KP_1 = 0x00070059u,
	PLATFORM_KEYCODE_KP_2 = 0x0007005Au,
	PLATFORM_KEYCODE_KP_3 = 0x0007005Bu,
	PLATFORM_KEYCODE_KP_4 = 0x0007005Cu,
	PLATFORM_KEYCODE_KP_5 = 0x0007005Du,
	PLATFORM_KEYCODE_KP_6 = 0x0007005Eu,
	PLATFORM_KEYCODE_KP_7 = 0x0007005Fu,
	PLATFORM_KEYCODE_KP_8 = 0x00070060u,
	PLATFORM_KEYCODE_KP_9 = 0x00070061u,
	PLATFORM_KEYCODE_KP_0 = 0x00070062u,
	PLATFORM_KEYCODE_KP_PERIOD = 0x00070063u,
	PLATFORM_KEYCODE_KP_EQUAL = 0x00070067u,
	PLATFORM_KEYCODE_KP_COMMA = 0x00070085u,
	PLATFORM_KEYCODE_KP_EQUAL_AS400 = 0x00070086u,
	/* Non-US and international */
	PLATFORM_KEYCODE_NON_US_BACKSLASH_PIPE = 0x00070064u,
	PLATFORM_KEYCODE_INTERNATIONAL1 = 0x00070087u,
	PLATFORM_KEYCODE_INTERNATIONAL2 = 0x00070088u,
	PLATFORM_KEYCODE_INTERNATIONAL3 = 0x00070089u,
	PLATFORM_KEYCODE_INTERNATIONAL4 = 0x0007008Au,
	PLATFORM_KEYCODE_INTERNATIONAL5 = 0x0007008Bu,
	PLATFORM_KEYCODE_INTERNATIONAL6 = 0x0007008Cu,
	PLATFORM_KEYCODE_INTERNATIONAL7 = 0x0007008Du,
	PLATFORM_KEYCODE_INTERNATIONAL8 = 0x0007008Eu,
	PLATFORM_KEYCODE_INTERNATIONAL9 = 0x0007008Fu,
	PLATFORM_KEYCODE_LANG1 = 0x00070090u,
	PLATFORM_KEYCODE_LANG2 = 0x00070091u,
	PLATFORM_KEYCODE_LANG3 = 0x00070092u,
	PLATFORM_KEYCODE_LANG4 = 0x00070093u,
	PLATFORM_KEYCODE_LANG5 = 0x00070094u,
	PLATFORM_KEYCODE_LANG6 = 0x00070095u,
	PLATFORM_KEYCODE_LANG7 = 0x00070096u,
	PLATFORM_KEYCODE_LANG8 = 0x00070097u,
	PLATFORM_KEYCODE_LANG9 = 0x00070098u,
	/* Application and power */
	PLATFORM_KEYCODE_APPLICATION = 0x00070065u,
	PLATFORM_KEYCODE_POWER = 0x00070066u,
	/* Editing and UI */
	PLATFORM_KEYCODE_EXECUTE = 0x00070074u,
	PLATFORM_KEYCODE_HELP = 0x00070075u,
	PLATFORM_KEYCODE_MENU = 0x00070076u,
	PLATFORM_KEYCODE_SELECT = 0x00070077u,
	PLATFORM_KEYCODE_STOP = 0x00070078u,
	PLATFORM_KEYCODE_AGAIN = 0x00070079u,
	PLATFORM_KEYCODE_UNDO = 0x0007007Au,
	PLATFORM_KEYCODE_CUT = 0x0007007Bu,
	PLATFORM_KEYCODE_COPY = 0x0007007Cu,
	PLATFORM_KEYCODE_PASTE = 0x0007007Du,
	PLATFORM_KEYCODE_FIND = 0x0007007Eu,
	PLATFORM_KEYCODE_ALTERNATE_ERASE = 0x00070099u,
	PLATFORM_KEYCODE_SYSREQ_ATTENTION = 0x0007009Au,
	PLATFORM_KEYCODE_CANCEL = 0x0007009Bu,
	PLATFORM_KEYCODE_CLEAR = 0x0007009Cu,
	PLATFORM_KEYCODE_PRIOR = 0x0007009Du,
	PLATFORM_KEYCODE_RETURN = 0x0007009Eu,
	PLATFORM_KEYCODE_SEPARATOR = 0x0007009Fu,
	PLATFORM_KEYCODE_OUT = 0x000700A0u,
	PLATFORM_KEYCODE_OPER = 0x000700A1u,
	PLATFORM_KEYCODE_CLEAR_AGAIN = 0x000700A2u,
	PLATFORM_KEYCODE_CRSEL_PROPS = 0x000700A3u,
	PLATFORM_KEYCODE_EXSEL = 0x000700A4u,
	/* Volume */
	PLATFORM_KEYCODE_MUTE = 0x0007007Fu,
	PLATFORM_KEYCODE_VOLUME_UP = 0x00070080u,
	PLATFORM_KEYCODE_VOLUME_DOWN = 0x00070081u,
	/* Locking variants */
	PLATFORM_KEYCODE_LOCKING_CAPS_LOCK = 0x00070082u,
	PLATFORM_KEYCODE_LOCKING_NUM_LOCK = 0x00070083u,
	PLATFORM_KEYCODE_LOCKING_SCROLL_LOCK = 0x00070084u,
	/* Modifiers */
	PLATFORM_KEYCODE_LEFT_CONTROL = 0x000700E0u,
	PLATFORM_KEYCODE_LEFT_SHIFT = 0x000700E1u,
	PLATFORM_KEYCODE_LEFT_ALT = 0x000700E2u,
	PLATFORM_KEYCODE_LEFT_GUI = 0x000700E3u,
	PLATFORM_KEYCODE_RIGHT_CONTROL = 0x000700E4u,
	PLATFORM_KEYCODE_RIGHT_SHIFT = 0x000700E5u,
	PLATFORM_KEYCODE_RIGHT_ALT = 0x000700E6u,
	PLATFORM_KEYCODE_RIGHT_GUI = 0x000700E7u
};

enum platform_keymod {
	PLATFORM_KEYMOD_NONE = 0,
	PLATFORM_KEYMOD_LEFT_SHIFT = 1u << 0,
	PLATFORM_KEYMOD_RIGHT_SHIFT = 1u << 1,
	PLATFORM_KEYMOD_LEFT_CTRL = 1u << 2,
	PLATFORM_KEYMOD_RIGHT_CTRL = 1u << 3,
	PLATFORM_KEYMOD_LEFT_ALT = 1u << 4,
	PLATFORM_KEYMOD_RIGHT_ALT = 1u << 5,
	PLATFORM_KEYMOD_LEFT_SUPER = 1u << 6,
	PLATFORM_KEYMOD_RIGHT_SUPER = 1u << 7
	/* TODO: Add missing keymods. */
};

enum platform_event_type {
	PLATFORM_EVENT_TYPE_NONE,
	PLATFORM_EVENT_TYPE_KEY_PRESS,
	PLATFORM_EVENT_TYPE_KEY_RELEASE
	/* TODO: Add missing event types." */
};

struct platform_key {
	enum platform_keycode keycode;
	enum platform_keymod keymod;
};

struct platform_event {
	enum platform_event_type type;
	struct platform_key key;
	/* TODO: Finish implementing. */
};

struct platform_window_desc {
	int32_t x;
	int32_t y;
	int32_t width;
	int32_t height;
	char title[PLATFORM_WINDOW_TITLE_MAX_LEN];
};

struct platform_window {
	uintptr_t handle;
};

struct platform_present_info {
	const void *buffer;
	int32_t width;
	int32_t height;
	int32_t pitch;
};

bool platform_start(void);
void platform_shutdown(void);
void platform_window_init(struct platform_window *window,
		struct platform_window_desc window_desc);
void platform_window_finish(struct platform_window *window);
struct platform_window_desc platform_window_get_desc(
		struct platform_window *window);
struct platform_event platform_poll_event(void);
void platform_present_rgba8_buffer(struct platform_window *window,
		struct platform_present_info present_info);


#endif /* PLATFORM_H */
